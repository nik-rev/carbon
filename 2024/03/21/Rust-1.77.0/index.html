<!doctype html><html data-theme=dark lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta media="(prefers-color-scheme: light)" content=#418001 name=theme-color><meta media="(prefers-color-scheme: dark)" content=#cbefa6 name=theme-color><title>
        Carbon's Blog | Announcing Rust 1.77.0
      </title><link href="https://carbon.nikrev.com/css/index.css?h=3e22f41332e248e40d6e" rel=stylesheet><script defer src=/js/code_blocks.js></script><script defer src=/js/theme_toggle.js></script><meta content="Nik Revenco" name=author><meta value="Announcing Rust 1.77.0" key=title property=og-image-generator><meta content="Carbon's Blog | Announcing Rust 1.77.0" property=og:title><meta content="A minimalistic Zola theme" property=og:description><meta content="Carbon's Blog | Announcing Rust 1.77.0" itemprop=headline><meta content="A minimalistic Zola theme" name=description><meta content=https://carbon.nikrev.com/2024/03/21/Rust-1.77.0/ property=og:url><meta content=summary_large_image name=og:type><meta content=summary_large_image property=twitter:card><meta content="Carbon's Blog | Announcing Rust 1.77.0" property=twitter:title><meta content=https://carbon.nikrev.com/2024/03/21/Rust-1.77.0/og.png property=og:image><meta content="Carbon's Blog | Announcing Rust 1.77.0" property=og:image:alt><meta content=1280 property=og:image:width><meta content=675 property=og:image:height><meta content=1280 property=twitter:image:width><meta content=675 property=twitter:image:height><body><div id=site><header class=header><div class=header__heading><h1 class=header__heading__title> Carbon's Blog</h1><div class=header__heading__icon-container><button aria-label="Change to light theme" title="Change to light theme" class=header__heading__theme-toggle type=button>  <svg viewbox="0 0 512 512" class=header__heading__theme-toggle__icon fill=currentColor stroke=currentColor stroke-width=0 xmlns=http://www.w3.org/2000/svg><path d="M264 480A232 232 0 0 1 32 248c0-94 54-178.28 137.61-214.67a16 16 0 0 1 21.06 21.06C181.07 76.43 176 104.66 176 136c0 110.28 89.72 200 200 200 31.34 0 59.57-5.07 81.61-14.67a16 16 0 0 1 21.06 21.06C442.28 426 358 480 264 480z"></path></svg></button><button aria-label="RSS Feed" title="RSS Feed" class=header__heading__rss type=button><a href=https://carbon.nikrev.com/atom.xml> <svg viewbox="0 0 512 512" class=header__heading__rss__icon fill=currentColor stroke=currentColor stroke-width=0 xmlns=http://www.w3.org/2000/svg><path d="M119.9 336.1c-30.8 0-55.9 25.1-55.9 55.8 0 30.8 25.1 55.6 55.9 55.6 30.9 0 55.9-24.9 55.9-55.6 0-30.7-25-55.8-55.9-55.8z"></path><path d="M64 192v79.9c48 0 94.1 14.2 128 48.1 33.9 33.9 48 79.9 48 128h80c0-139.9-116-256-256-256z"></path><path d="M64 64v79.9c171 0 303.9 133 303.9 304.1H448C448 236.3 276 64 64 64z"></path></svg> </a></button></div></div><nav><ul class=header__links><li><a class=header__links__link href=/> /home </a><li><a class=header__links__link href=/features> /features </a><li><a class=header__links__link href=/blog> /blog </a><li><a class=header__links__link href=/installation> /installation.md </a></ul></nav></header><main class=post-content><h1 class=post-content__title>Announcing Rust 1.77.0</h1><p class=post-content__date>21 March, 2024<p>The Rust team is happy to announce a new version of Rust, 1.77.0. Rust is a programming language empowering everyone to build reliable and efficient software.<p>If you have a previous version of Rust installed via <code>rustup</code>, you can get 1.77.0 with:<pre class=z-code><code><span class="z-text z-plain">$ rustup update stable
</span></code></pre><p>If you don’t have it already, you can <a href=https://www.rust-lang.org/install.html>get <code>rustup</code></a> from the appropriate page on our website, and check out the <a href=https://doc.rust-lang.org/nightly/releases.html#version-77-2024-03-21>detailed release notes for 1.77.0</a>.<p>If you’d like to help us out by testing future releases, you might consider updating locally to use the beta channel (<code>rustup default beta</code>) or the nightly channel (<code>rustup default nightly</code>). Please <a href=https://github.com/rust-lang/rust/issues/new/choose>report</a> any bugs you might come across!<h2 id=what-s-in-1-77-0-stable><a aria-label="Anchor link for: what-s-in-1-77-0-stable" class=zola-anchor href=#what-s-in-1-77-0-stable>What’s in 1.77.0 stable</a></h2><p>This release is relatively minor, but as always, even incremental improvements lead to a greater whole. A few of those changes are highlighted in this post, and others may yet fill more niche needs.<h3 id=c-string-literals><a aria-label="Anchor link for: c-string-literals" class=zola-anchor href=#c-string-literals>C-string literals</a></h3><p>Rust now supports C-string literals (<code>c"abc"</code>) which expand to a nul-byte terminated string in memory of type <code>&'static CStr</code>. This makes it easier to write code interoperating with foreign language interfaces which require nul-terminated strings, with all of the relevant error checking (e.g., lack of interior nul byte) performed at compile time.<h3 id=support-for-recursion-in-async-fn><a aria-label="Anchor link for: support-for-recursion-in-async-fn" class=zola-anchor href=#support-for-recursion-in-async-fn>Support for recursion in <code>async fn</code></a></h3><p>Async functions previously could not call themselves due to a compiler limitation. In 1.77, that limitation has been lifted, so recursive calls are permitted so long as they use some form of indirection to avoid an infinite size for the state of the function.<p>This means that code like this now works:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">async <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">fib</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">n</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-storage z-type z-rust">u32</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> <span class="z-storage z-type z-rust">u32</span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">   <span class="z-keyword z-control z-rust">match</span> n <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">       <span class="z-constant z-numeric z-integer z-decimal z-rust">0</span> <span class="z-keyword z-operator z-bitwise z-rust">|</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">1</span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-constant z-numeric z-integer z-decimal z-rust">1</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">       <span class="z-keyword z-operator z-rust">_</span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">Box</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>pin<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-support z-function z-rust">fib</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>n<span class="z-keyword z-operator z-arithmetic z-rust">-</span><span class="z-constant z-numeric z-integer z-decimal z-rust">1</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span>await <span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-support z-type z-rust">Box</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>pin<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-support z-function z-rust">fib</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>n<span class="z-keyword z-operator z-arithmetic z-rust">-</span><span class="z-constant z-numeric z-integer z-decimal z-rust">2</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span>await
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">   </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><h3 id=offset-of><a aria-label="Anchor link for: offset-of" class=zola-anchor href=#offset-of><code>offset_of!</code></a></h3><p>1.77.0 stabilizes <a href=https://doc.rust-lang.org/stable/std/mem/macro.offset_of.html><code>offset_of!</code></a> for struct fields, which provides access to the byte offset of the relevant public field of a struct. This macro is most useful when the offset of a field is required without an existing instance of a type. Implementing such a macro is already possible on stable, but without an instance of the type the implementation would require tricky unsafe code which makes it easy to accidentally introduce undefined behavior.<p>Users can now access the offset of a public field with <code>offset_of!(StructName, field)</code>. This expands to a <code>usize</code> expression with the offset in bytes from the start of the struct.<h3 id=enable-strip-in-release-profiles-by-default><a aria-label="Anchor link for: enable-strip-in-release-profiles-by-default" class=zola-anchor href=#enable-strip-in-release-profiles-by-default>Enable strip in release profiles by default</a></h3><p>Cargo <a href=https://doc.rust-lang.org/stable/cargo/reference/profiles.html>profiles</a> which do not enable <a href=https://doc.rust-lang.org/stable/cargo/reference/profiles.html#debug>debuginfo</a> in outputs (e.g., <code>debug = 0</code>) will enable <code>strip = "debuginfo"</code> by default.<p>This is primarily needed because the (precompiled) standard library ships with debuginfo, which means that statically linked results would include the debuginfo from the standard library even if the local compilations didn’t explicitly request debuginfo.<p>Users which do want debuginfo can explicitly enable it with the <a href=https://doc.rust-lang.org/stable/cargo/reference/profiles.html#debug>debug</a> flag in the relevant Cargo profile.<h3 id=stabilized-apis><a aria-label="Anchor link for: stabilized-apis" class=zola-anchor href=#stabilized-apis>Stabilized APIs</a></h3><ul><li><a href=https://doc.rust-lang.org/stable/std/primitive.array.html#method.each_ref><code>array::each_ref</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.array.html#method.each_mut><code>array::each_mut</code></a><li><a href=https://doc.rust-lang.org/stable/core/net/index.html><code>core::net</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.f32.html#method.round_ties_even><code>f32::round_ties_even</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.f64.html#method.round_ties_even><code>f64::round_ties_even</code></a><li><a href=https://doc.rust-lang.org/stable/std/mem/macro.offset_of.html><code>mem::offset_of!</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.first_chunk><code>slice::first_chunk</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.first_chunk_mut><code>slice::first_chunk_mut</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.split_first_chunk><code>slice::split_first_chunk</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.split_first_chunk_mut><code>slice::split_first_chunk_mut</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.last_chunk><code>slice::last_chunk</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.last_chunk_mut><code>slice::last_chunk_mut</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.split_last_chunk><code>slice::split_last_chunk</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.split_last_chunk_mut><code>slice::split_last_chunk_mut</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.chunk_by><code>slice::chunk_by</code></a><li><a href=https://doc.rust-lang.org/stable/std/primitive.slice.html#method.chunk_by_mut><code>slice::chunk_by_mut</code></a><li><a href=https://doc.rust-lang.org/stable/std/ops/enum.Bound.html#method.map><code>Bound::map</code></a><li><a href=https://doc.rust-lang.org/stable/std/fs/struct.File.html#method.create_new><code>File::create_new</code></a><li><a href=https://doc.rust-lang.org/stable/std/sync/struct.Mutex.html#method.clear_poison><code>Mutex::clear_poison</code></a><li><a href=https://doc.rust-lang.org/stable/std/sync/struct.RwLock.html#method.clear_poison><code>RwLock::clear_poison</code></a></ul><h3 id=other-changes><a aria-label="Anchor link for: other-changes" class=zola-anchor href=#other-changes>Other changes</a></h3><p>Check out everything that changed in <a href=https://github.com/rust-lang/rust/releases/tag/1.77.0>Rust</a>, <a href=https://doc.rust-lang.org/nightly/cargo/CHANGELOG.html#cargo-177-2024-03-21>Cargo</a>, and <a href=https://github.com/rust-lang/rust-clippy/blob/master/CHANGELOG.md#rust-177>Clippy</a>.<h2 id=contributors-to-1-77-0><a aria-label="Anchor link for: contributors-to-1-77-0" class=zola-anchor href=#contributors-to-1-77-0>Contributors to 1.77.0</a></h2><p>Many people came together to create Rust 1.77.0. We couldn’t have done it without all of you. <a href=https://thanks.rust-lang.org/rust/1.77.0/>Thanks!</a></main><footer><p>Powered by <a href=https://github.com/getzola/zola>Zola</a> and <a href=https://github.com/nik-rev/carbon>nik-rev/carbon</a></footer></div>