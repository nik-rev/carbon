{% extends "index.html" %}

{% block head_variables %}
  {% set title = section.title | default(value=config.title) %}
  {% set description = section.description %}

  {% set og_image_title = section.title %}
  {% set og_image_description = section.description %}
{% endblock head_variables %}

{% block heading %}
  {% set title = section.title | default(value=config.title) %}
  {{ title }}
{% endblock heading %}

{% block head %}
  <style>
    .posts__year, .posts {
      list-style-type: none;
    }
    .posts-content {
      margin-bottom: 2em;
    }
    .posts {
      padding-left: 0;
      .posts__title {
        margin-bottom: 3rem;
      }
      .posts__year {
        padding: 0;
        width: 100%;
      }
      .post {
        display: flex;
        flex-direction: column;
        margin-bottom: 3rem;
        line-height: 1.6;
        font-size: 1.4rem;
        .post__date {
          margin: 0;
          color: var(--secondary);
        }
        .post__link {
          text-decoration: none;
          &:hover {
            text-decoration: underline;
          }
        }
      }
    }
    @media (width >= 600px) {
      .posts .post {
        display: grid;
        grid-template-columns: 5rem 1fr;
        column-gap: 6.0rem;
        margin-bottom: 4rem;
        width: full;
        .post__date {
          width: max-content;
          align-content: center;
        }
      }
    }
    .header-links {
      display: flex;
      gap: 0.5em;
      a {
        text-decoration: none;
        &:hover {
          text-decoration: underline;
        }
      }
    }
  </style>
{% endblock head %}

{% block content %}
  <main>
    <!-- Contents of `blog/_index.md` -->
    <div class="posts-content">
      {{ section.content | safe }}
    </div>

    <!-- List of blog posts, by year -->
    {% set parent = get_section(path=section.relative_path, metadata_only=true) %}
    {% if parent.extra.order_by_year %}
      <ul class="posts">
        {% for year, posts_that_year in section.pages | group_by(attribute="year") %}
          <h2 class="posts__title">Posts in {{ year }}</h2>
          <ul class="posts__year">
            {% for post in posts_that_year %}
              <li class="post">
                <p class="post__date">{{ post.date | date(format="%-d %b") }}</p>
                <a href="{{ post.permalink }}" class="post__link">
                  {{ post.title | markdown(inline=true) | safe }}
                </a>
              </li>
            {% endfor %}
          </ul>
        {% endfor %}
      </ul>
    {% else %}
      <ul>
        {% for post in section.pages %}
          <li>
            <a href="{{ post.permalink }}">
              {{ post.title | markdown(inline=true) | safe }}
            </a>
          </li>
        {% endfor %}
      </ul>
    {% endif %}
  </main>
{% endblock content %}
